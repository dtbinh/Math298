\documentclass[mathserif,notes]{beamer}
\usepackage{mybeamertheme}
%\usepackage{pdfsync} % works only on TeXShop, comment otherwise
\usepackage{pgf}
\usepackage{multimedia} % to embed movies in the PDF file
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{comment}
\usepackage{pgfpages}

\mode<presentation>
{
  \usetheme{Madrid}   %  \usetheme{Warsaw}
  % Note: this next command makes nice slides, but Adobe doesn't like it (you get blank pages)
  %\setbeamertemplate{background canvas}[vertical shading][bottom=white,top=structure.fg!15]
  \setbeamertemplate{footline}{\pgfuseimage{UCM-logo}}

  %\usecolortheme{seahorse}
  \usecolortheme{beaver}
  \setbeamercovered{transparent}
}
%\usepackage[T1]{fontenc}
% For printing purposes only
%\pgfpagesuselayout{4 on 1}[letterpaper,border shrink=5mm,landscape]

\usepackage{amssymb,amsmath}
\hypersetup{%
 pdftitle={ISMP2012},
 pdfauthor={Juan Meza(UC Merced)},
 pdfsubject={},
 pdfkeywords={}
 }
 
\title[Derivative-Free Optimization Methods]{Derivative-Free Optimization Methods for \\
Determining the Surface Structure of Nanosystems}  \subtitle{}
\author[Juan Meza]{Juan Meza \\ University of California, Merced}
\date[August 19-24, 2012]{21st International Symposium on Mathematical Programming \\  August 19-24 2012 Berlin, Germany}
\institute[UC Merced]

\pgfdeclareimage[height=0.35cm]{UCM-logo}{UCM-logo}
% \logo{\pgfuseimage{UCM-logo}}

%% figures

\input{latex-defs}

\definecolor{navy}{RGB}{0,0,128}
\definecolor{forestgreen}{RGB}{34,139,34}
\definecolor{mylightsteelblue}{RGB}{176,196,222}
\definecolor{mylightcyan}{RGB}{180,255,255}
\definecolor{mypaleturquoise}{RGB}{175,238,238}
\definecolor{mylightgoldenrod}{RGB}{250,250,210}
\definecolor{mylightyellow}{RGB}{255,255,224}
\definecolor{mylightsalmon}{RGB}{255,160,122}

\setbeamercolor{blacklightsteelblue}{fg=black,bg=mylightsteelblue}
\setbeamercolor{blackpaleturquoise}{fg=black,bg=mypaleturquoise}
\setbeamercolor{blacklightcyan}{fg=black,bg=mylightcyan}
\setbeamercolor{blacklightgoldenrod}{fg=black,bg=mylightgoldenrod}
\setbeamercolor{blacklightyellow}{fg=black,bg=mylightyellow}
\setbeamercolor{blacklightsalmon}{fg=black,bg=mylightsalmon}
\setbeamercolor{blackcyan}{fg=black,bg=cyan}




\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{

\titlepage

} % end frame

\section{Motivation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{Surface structure determination}

\begin{itemize}
\item Surface structure determines many important properties of materials.
\item Possibility of electron diffraction first proposed by deBroglie (1924).
\item Over 40 years before it became a tool in surface structure determination. 
\item Low-energy electrons are surface sensitive, requiring a well-ordered surface.
\item Experimental data could not be quantitatively described by kinematic theory and necessitated the development of a theory of multiple scattering in the late 1960s.
\end{itemize}
} % end frame


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{Low-energy electron diffraction (LEED)}

\begin{columns}

\begin{column}{0.5\textwidth}
\includegraphics[width=\textwidth]{nanofigs/LEEDpattern}
\end{column}

\begin{column}{0.5\textwidth}
\begin{itemize}
\item Goal is to determine surface structure  through low energy electron diffraction (LEED).
\item Need to determine the coordinates and chemical identity of each atom: Li atoms on a Ni surface
\item Non-structural parameters, i.e. inner potential, phase shift $\delta$, thermal effects and damping. 
\item {\footnotesize \url{www.answers.com/topic/low-energy-electron-diffraction}}
\end{itemize}
\end{column}

\end{columns}
} % end frame

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{Surface structure determination using LEED}

\begin{columns}

\begin{column}{0.5\textwidth}
\pgfputat{\pgfxy(0,-5.0)}{\pgfbox[left,base]{\pgfimage[height=0.9\textheight]{nanofigs/Structuretypes}}}
\end{column}

\begin{column}{0.5\textwidth}
\pgfputat{\pgfxy(0.0,-2.5)}{\pgfbox[left,base]{\pgfimage[height=0.65\textheight]{nanofigs/Model31}}}
\end{column}
\end{columns}
} % end frame

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{LEED setup}

\pgfputat{\pgfxy(0.0,-4.0)}{\pgfbox[left,base]{\pgfimage[width=\textwidth]{nanofigs/LEEDsetupall}}}

} % end frame

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{Pendry R-factor}

\begin{itemize}
\item Pendry R(eliability) -factor (1980) is defined by:
\begin{eqnarray*}
   R  & = & {} \sum_{i,g} ( Y_{gth} - Y_{gexp} )^2 /   \sum_{i,g} ( Y_{gth}^2 + Y_{gexp}^2 ) \\
   Y(E) & = & {}  L / ( 1 + {LV_{oi}}^2 ),\\
   L(E) & = & {} I' / I ,\\
   L & \approx {} & \sum_j \frac{-2(E-E_j)}{(E - E_j)^2 + V_{oi}^2} 
\end{eqnarray*}
\item LEED curves consist for the main part of a series of Lorentzian peaks: $I \approx \sum a_j / (E - E_j)^2 + V_{oi}^2$
\item Their widths are dictated by the imaginary part of the electron self-energy (optical potential):  $\Delta E = 2 | V_{oi} |$
\item Pendry R-factor emphasizes positions of the maximum and minimum rather than the heights of the intensities
\item Ideal agreement corresponds to $R = 0$; uncorrelated spectra yields $R = 1$.
\end{itemize}


} % end frame

\section{Formulation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{Optimization formulation}

\begin{itemize}
\item Inverse problem
\begin{itemize}
\item minimize R-factor - defined as the misfit between theory an experiment
\item Several ways of computing the R-factor, we will use the Pendry R-factor.
\end{itemize}
\item Combination of continuous and categorical variables
\begin{itemize}
\item Atomic coordinates: x, y, z
\item Chemical identity:  Ni, Li
\end{itemize}
\item No derivatives available; function may also be discontinuous
\item Invalid (unphysical) structures lead to function being undefined in certain regions and returning “special values”
\end{itemize}

} % end frame

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{Previous Work}

\begin{itemize}
\item Early attempts used Hooke-Jeeves, nonlinear least squares, genetic algorithms$^{1-2}$, …
\item We have also used pattern search methods
\item Effective, but expensive
\begin{itemize}
\item Several 100 to 1000s of function calls typically needed
\item Each function call can take up to 2 minutes on a workstation class computer
\end{itemize}
\end{itemize}
\vspace{5ex}
\footnotesize{
\begin{enumerate}
\item Global Optimization in LEED Structure Determination Using Genetic Algorithms, R. Döll and M.A. Van Hove, Surf. Sci. 355, L393-8 (1996). 
\item G. S. Stone, MS dissertation, Computer Science Dept., San Francisco State University, 1998.
\end{enumerate}
}
} % end frame


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{General MVP algorithm}

\vspace*{2ex} \hrule \vspace*{-5ex}
\begin{tabbing}
\hspace*{4ex} \=\hspace*{2ex} \= \hspace*{2ex} \= \hspace*{2ex} \= \hspace*{2ex} \=\\
Initialization:  Given values $\Delta_0, x_0, M_0, P_0$, \\[1ex]
1\> For $k = 0, \ldots, {\sf maxit}$ do  \\
2\>\> \structure{Search}: Evaluate $f$ on a finite subset of trial points on the mesh $M_k$. \\
3\>\> \structure{Poll}: Evaluate $f$ on the frame $P_k$.  \\
4\>\> If (successful) \\
5\>\>\> $x_{k+1} = x_k + \Delta_k d_k$ \\
6\>\>\> Update $\Delta_k$ \\
7\>End
\end{tabbing}
\vspace*{-2ex} \hrule \vspace*{2ex}
\begin{itemize}
\item Global \structure{Search} phase can include user heuristics or {\color{forestgreen} surrogate} functions \\
\item Local \structure{Poll} phase is more rigid, but needed to ensure convergence. \\
\end{itemize}
} % end frame

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{Variations on LEED}
\begin{itemize}
\item LEED
\begin{itemize}
\item Multiple scattering model
\item I-V spectra computed repeatedly until best-fit structure is found
\item Computation time is proportional to the number of parameters
\end{itemize}
\item TLEED (Tensor LEED)
\begin{itemize}
\item For a reference structure use multiple scattering
\item Perturbation method to calculate I-V for a structure close to a reference structure
\item Efficient for local modifications (i.e. no categorical variables) - otherwise computationally expensive
\end{itemize}
\end{itemize}

} % end frame


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{Kinematic LEED as a simplified physics surrogate (SPS)}
\begin{itemize}
\item R-factor depends on:
\begin{itemize}
\item Structural parameters, i.e. atomic positions, chemical identity
\item Non-structural parameters, i.e. inner potential, phase shift $\delta$, thermal effects and damping. 
\end{itemize}
\item KLEED (Kinematic LEED)
\begin{itemize}
\item Basic assumption is that electrons are only scattered once by the surface atoms.
\item Surface unit cell size and symmetry can be determined, but not the exact positions.
\item Compared to multiple scattering which takes $\approx$ 2 minutes to compute, I-V spectra from KLEED can be computed in a few seconds.
\end{itemize}

\end{itemize}

} % end frame

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{KLEED versus TLEED(multiple-scattering)}
\begin{columns}
\begin{column}{0.6\textwidth}
\pgfputat{\pgfxy(0,-4.5)}{\pgfbox[left,base]{\pgfimage[height=0.85\textheight]{nanofigs/KLEEDvsMS}}}
\end{column}
\begin{column}{0.4\textwidth}
\begin{itemize}
\item KLEED agrees well with experimental data as long as the incident angle is close to perpendicular
\item KLEED and multiple scattering agree well with small phase shift, i.e. as $\delta \rightarrow 0$.
\item However for larger phase shift there is no guarantee of agreement
\end{itemize}
\end{column}
\end{columns}
} % end frame

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{KLEED as a simplified physics surrogate}

\pgfputat{\pgfxy(-0.5,-4.5)}{\pgfbox[left,base]{\pgfimage[width=\textwidth]{nanofigs/relKLEEDerr}}}

}% end frame

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{Simplified physics surrogate (SPS)}
\begin{itemize}
\item Define $\phi_A (x) = \phi_S + \phi_I$, where 
\begin{align*} % requires amsmath; align* for no eq. number
   \phi_A  = & \mbox{Additive surrogate}, \\
   \phi_S = & \mbox{Simplified physics surrogate, e.g. KLEED}, \\
   \phi_I = & \mbox{Interpolatory surrogate, e.g. DACE model} \\
\end{align*}
\end{itemize}
\structure{Search}:
\vspace*{1ex} \hrule \vspace*{-5ex}
\begin{tabbing}
\hspace*{4ex} \=\hspace*{2ex} \= \hspace*{2ex} \= \hspace*{2ex} \= \hspace*{2ex} \=\\
1\>  if (first search step) \{ \\
2\>\> Initialize $\phi_{I}$ with Latin Hypercube sample.  \\
3\>else \{ \\
4\>\> recalibrate $\phi_{I}$ with DACE model of $\phi_S - f$.  \\
5\>\> \} \\
6\> Construct $\phi_A = \phi_S + \phi_I $\\
7\> Solve min $\phi_A $ %= \phi_S + \phi_I $\\
\end{tabbing}
\vspace*{-2ex} \hrule \vspace*{2ex}
} % end frame

\section{Numerical Results}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{Test problem}
\begin{columns}

\begin{column}{0.5\textwidth}
\pgfputat{\pgfxy(0,-5.0)}{\pgfbox[left,base]{\pgfimage[height=0.9\textheight]{nanofigs/testprob}}}
\end{column}

\begin{column}{0.45\textwidth}
\begin{itemize}
\item Model 31 from set of model problem using three layers
\begin{itemize}
\item 14 atoms 
\item 14 categorical variables
\item 42 continuous variables
\end{itemize}
\item Additional constraint added so that positions of atoms are constrained to lie within a box
\item Used NOMADm, developed by M. Abramson

\end{itemize}
\end{column}

\end{columns}

} % end frame


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{Test cases}
\begin{itemize}
\item Start with best known feasible point
\item Three different approaches
\begin{itemize}
\item No search step
\item LHS search
\item Simplified physics surrogate (DACE model)
\begin{itemize}
\item LHS with 5 and 15 points
\item $\Delta = 1.0$
\item $\Delta = 0.1$
\end{itemize}
\end{itemize}


\end{itemize}

} % end frame

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{Optimization of continuous variables using no search phase}

\begin{columns}
\begin{column}{.5\textwidth}
\pgfputat{\pgfxy(0.0,-3.0)}{\pgfbox[left,base]{\pgfimage[width=\textwidth]{nanofigs/TLEED-nosearch-del.01}}}
\end{column}
\begin{column}{.5\textwidth}
\pgfputat{\pgfxy(0.0,-3.0)}{\pgfbox[left,base]{\pgfimage[width=\textwidth]{nanofigs/TLEED-nosearch-del1.0}}}
\end{column}
\end{columns}

}% end frame

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{Optimization using LHS with 40 points}

\pgfputat{\pgfxy(-0.5,-8.0)}{\pgfbox[left,base]{\pgfimage[width=\textwidth]{nanofigs/lhs40}}}

}% end frame

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{Optimization using additive surrogate, $\Delta_0 = 1.0$}

\pgfputat{\pgfxy(0.0,-5.0)}{\pgfbox[left,base]{\pgfimage[width=0.85\textwidth]{nanofigs/lhs15-spsdace}}}

}% end frame
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{Optimization using additive surrogate, $\Delta_0 = 0.1$}

\pgfputat{\pgfxy(-0.5,-7.5)}{\pgfbox[left,base]{\pgfimage[width=0.95\textwidth]{nanofigs/lhs5-spsdace5}}}
}% end frame

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{Summary of numerical results}

\Large{
\begin{center}
\begin{tabular}{|c|c|c|c|}
   \hline 
   Method & LHS &  $f(x^*)$ & fevals \\ \hline
   No search & $ 0 $ & $ 0.2551$ & $180$         \\  \hline
   LHS & $ 40 $ & $ 0.2551$ & $160$         \\ \hline 
   SPS+DACE & $ 15 $ & $ 0.2543$ & $180$             \\  \hline  
   SPS+DACE & $ 5 $ & $ {\color{darkred}0.2354}$ & ${\color{darkred}135}$          \\ \hline 
        
\end{tabular}
\end{center}
}
} % end frame

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{LEED Chemical Identity Search: Ni (100)-(5x5)-Li}

\includegraphics[width=2.5in]{nanofigs/Newstruct}
\includegraphics[width=2.5in]{nanofigs/Bestknownstruct}

}% end frame

\section{Summary}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{\frametitle{Summary}

\begin{itemize}
\item Preliminary results indicate that performance can be  enhanced by using an additive surrogate function in the search phase.
\item Total number of function evaluations decreased by about 20\%, which represents a reduction of $\approx $ 2 hours per model.
\item Efficiency is (too) dependent on various algorithmic parameters.
\item Need to investigate alternatives to DACE model. 
\end{itemize}

}% end frame

\end{document}
